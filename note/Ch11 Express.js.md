## 11.2 Express의 큰그림, 중요 포인트!

```js

app.get('/', function (req, res, next) {

    ...

})

```

- 여기서 콜백함수에 해당하는 부분을 middleware라고 하고, express는 미들웨어의 연속이라고 할 수 있다.

<br/>

### Q. express 콜백함수 질문입니다.

```js

app.get('/', function (req, res, next) {

    ...

})

```

- 이런 코드가 있을 때 function(req, res...) 부분은

- 자바스크립트 event loop에 의해서 우선 다음코드로 넘어가고

- 나중에 task queue에 들어가게 된후 콜스택이 비게되면 실행되는게 맞나요??

### A.

- 그렇죠! 정확해요 :)

- function(req, res, next) 여기에 작성된 함수 코드들은 콜백함수로 우리가 명시한 '/' 경로에 이벤트가 발생하면 (즉, 클라이언트로부터 해당 경로에 request가 발생하면) 우리가 등록한 콜백함수가 노드 런타임 환경에 의해 태스크 큐에 들어 오게 되고, 이벤트 루프가 적절한 때에 우리의 콜스택으로 가지고 오게 되죠.

- 그래서 function(req, res, next) 함수 안에서 동기적으로 무언가 무거운 일들을 하지 않도록 주의하는 것이 좋아요 ❤️

- 포인트를 제대로 잡고 가시네요 👍

### Q.

- function(req, res, next) 함수에서 무거운 처리를 해야하는거 아닌가요?? 이게 비동기로 실행되니까?

- 엘리님 말씀대로면 무거운 처리를 어디서해야하나용?

### A.

- 우선 무거운 일들이 무엇인지 정의해 보면:

  - 무거운 일 === 블러킹이 발생하는 일들

- 파일을 읽거나 쓰는, 데이터 베이스를 읽거나 쓰는, 네트워크 통신을 하는 이런 일들을 말하겠죠?

- 이렇게 무거운 일들은 비동기적으로 하고 (노드에서 제공하는 API를 사용하거나 또는 데이터베이스를 읽는 함수들을 asnc/promise로 만들어요) 콜백함수에서는 처리된 그 결과값을 가지고 무언가를 업데이트 하는 등의 일들을 할 수 있어요

### Q.

- function(req, res, next)함수가 task queue에서 콜스택으로 넘어와서 실행될때 무거운 일을 하게 되면

- task queue에 있는 다른 함수들이 계속 기다려야 하니까

- function(req, res, next)안에서 다시한번 노드js가 제공하는 비동기함수를 써야한다

- 이렇게 이해하면 맞을까요?

### A.

- 그렇죠 🙌

---

## 11.3 서버 만들기

- https://expressjs.com/en/4x/api.html
