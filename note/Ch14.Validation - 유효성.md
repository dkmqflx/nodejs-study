## 14.1 유효성 검사란, 어디에서 하는게 좋을까?

- validation이란 클라이언트가 서버에게 특정한 요청을 보내는 데이터가 유효한지 확인하는 과정

- 보통 스키마가 확정된 데이터 베이스를 이용하면 어떤 특정한 필드에 어떤 데이터 타입인지 정의가 되어 있기 때문에 해당 요청에 필요한 데이터가 정상적으로 왔는지 validation을 데이터 베이스 쪽에서 확인할 수 있다

- 하지만 데이터베이스에서 유효성 검사를 할 때 까지 아무런 유효성 검사를 하지 않는 것은 최악이다

- 그래서 서버에서 유효성 검사를 할 수 있는데 빨리하면 할 수록 좋다.

  - 서버에서 데이터를 읽고 쓰는 것을 포함한 모든 것이 다 비용이기 때문

- 서버에 요청을 하게 되면 네트워크 비용도 발생하는데 이런 비용을 절약하기 위해 클라이언트 쪽에서도 validation을 할 수도 있다.

<br/>

## 14.2 Validation 라이브러리 소개 및 실습

### Q.

- 궁금한 게 있어요. 만약 저런 유효성 검사가 비용에 관해 민감한 것이라면, 프론트에서 검사가 되고 넘어가도록 하는 게 낫지 않나요?

### A.

- 유효성 검사는 백엔드는 필수! 적으로 해야 하고 프론트엔드에서 하는건 옵션! 사항입니다.

- 왜? 만약 해커가 우리 프론트엔드를 거치지 않고 API를 호출할 수 있기 때문.

<br/>

## 14.4 Sanitization이란? 중요성에 대해

- 유효성 검사를 하기 전에 Sanitization 해 주어야 한다

  - 즉, sanitization은 validation을 위한 전처리라고 볼 수 있다.

- 만약 trim()이 없다면 `name: "   kim "` 같은 형태로도 전달이 되어도 에러가 발생하지 않기 때문이다

```js

body("name").trim().isLength({ min: 2 }).withMessage("이름은 두글자 이상!"),

body("email").isEmail().withMessage("이메일 입력해요").normalizeEmail(), // 이메일의 경우 대문자가 아닌 소문자로 만들어준다

```

### Q.sanitization을 서버 입장에서 마음대로 해도 되는지 궁금합니다.

- 예를 들어 표준적인 데이터의 모양새를 잘 모르는 사용자가 의도적으로 이메일주소에 대문자를 포함했거나, 이름에 공백을 넣어서 저장했는데

- 그것이 자동으로 세니타이제이션 되어 저장이 된다면, 사용자 입장에서는 이상하게 여길 수도 있다고 생각이 들었어요.

- 그래서 이런 경우에 UI적으로 유효한 데이터를 입력하라는 경고메세지를 표시하는 것이 좋은 방법인지

- 서버에서 세니타이제이션을 그냥 해서 저장하는 것이 좋은 방법인지,

- 어떤 방식이 일반적인지 궁금합니다!

### A.

- 서버에서 sanitization은 필수이고, 좀더 나은 사용자의 경험 (UX)를 위해 클라이언트 단에서도 직관적으로 에러를 표시 하거나, 정확한 데이터를 사용자가 입력 할 수 있도록 유도해 주는게 좋아요

<br/>

## 14.6 드위터에 유효성 검사 적용해 보기 💡

- validation

  - 데이터베이스에서 읽고 쓰기 전에 하는 것이 좋다

  - 왜냐하면 데이터베이스가 다른 클라우드에 있다면 네트워크 비용이 발생할 수 있기 때문에 데이터가 유효한지 유효성 검사를 하는 것이 좋다

- sanitization

  - 데이터를 일관성 있게 보관하도록 한다

- Contract Testing: Client - Server

  - 클라이언트와 서버가 데이터를 주고 받을 때

  - 서버에서는 이렇게 구현되어 있고, 클라이언트에서는 이렇게 규격을 맞춰서 보내는 것을 테스트 하는 것

### Q.

- 코드 재사용성을 활용할 때 함수기반으로 사용할 때와 클래스 기반으로 사용할 때 두가지가 있던데 언제 어느 것을 사용하는 기준 같은게 있을까요?

- 제가 이해한 바로는 데이터 관련된 부분이 있으면 클래스로 재사용하고, 아니면 함수로 작성하는것 같은데 맞나요??

### A.

- 보통은 함께 그룹을 지어서 상태(데이터)와 행동(함수)로 만드는것이 좋은 경우 클래스를 사용하고, 개별적으로 함수 자체로 독립적으로 무언가를 수행하는 경우 static 함수나 그냥 함수로 작성하는것 같아요 :)

- 드위터 컨트롤러 함수들은 함께 연관되어져 있지만, 자바스크립트에서 모듈로 (클래스와 비슷하게) 묶어서 관리할 수 있기 때문에 함수단위로 작성해두었어요
